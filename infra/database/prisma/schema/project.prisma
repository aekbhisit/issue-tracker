// Project Registration Models

model Project {
  id            Int                  @id @default(autoincrement())
  name          String
  description   String?
  publicKey     String               @unique
  privateKey    String               @unique
  status        Boolean              @default(true)
  allowedDomains Json                // Array of allowed domains
  deletedAt     DateTime?            @map("deleted_at")
  createdAt     DateTime             @default(now()) @map("created_at")
  updatedAt     DateTime             @updatedAt @map("updated_at")
  environments  ProjectEnvironment[]
  issues        Issue[]
  
  @@index([status])
  @@index([deletedAt])
  @@index([createdAt])
  @@map("projects")
}

model ProjectEnvironment {
  id            Int      @id @default(autoincrement())
  projectId     Int      @map("project_id")
  name          String   // dev, stage, prod, etc.
  apiUrl        String?  @map("api_url")
  allowedOrigins Json?   @map("allowed_origins") // Array of allowed origins (optional, overrides project-level)
  isActive      Boolean  @default(true) @map("is_active")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  project       Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@unique([projectId, name])
  @@index([projectId])
  @@index([isActive])
  @@map("project_environments")
}

